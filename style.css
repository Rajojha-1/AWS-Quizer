:root{--bg:#6b21a8;--bg-2:#7c3aed;--card:#ffffffee;--muted:#f3e8ff}
*{box-sizing:border-box}
.body, body{font-family:Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(135deg,var(--bg),var(--bg-2));margin:0;color:#fff;min-height:100vh}
/* utility to hide elements until needed */
.hidden{display:none !important}
/* prevent page vertical scroll; stage centers content */
html,body{height:100%}
body{overflow:hidden}

/* Stage layout */
.kahoot-stage{display:flex;flex-direction:column;height:100vh;align-items:stretch}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:14px 20px}
.logo{font-weight:800;font-size:20px;letter-spacing:0.6px}
.top-controls{display:flex;gap:18px;align-items:center}
.progress{background:rgba(255,255,255,0.06);padding:8px 12px;border-radius:999px;font-weight:700}
.timer{background:rgba(0,0,0,0.12);padding:8px 12px;border-radius:999px;font-weight:800}

/* Centered question card */
.q-card{margin:auto;max-width:1100px;width:92%;background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.02));border-radius:20px;padding:24px;box-shadow:0 28px 80px rgba(2,6,23,0.36);display:flex;flex-direction:column;height:auto;max-height:none;min-height:auto;position:relative;overflow:hidden}
.question-area{padding:8px 6px 18px;flex-shrink:0}
.question-text{font-size:clamp(18px,3.5vw,28px);line-height:1.2;margin:0 0 12px;color:#fff;text-align:center;font-weight:800;max-height:none;overflow:visible;word-wrap:break-word}

/* Kahoot-like 2x2 answer grid */
.kahoot-choices{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin-top:12px;grid-auto-rows:minmax(70px,auto);max-height:none;overflow:visible}
.choice-btn{display:flex;align-items:center;gap:14px;padding:16px;border-radius:14px;border:4px solid rgba(0,0,0,0.08);cursor:pointer;color:#0b0b0b;font-weight:800;font-size:18px;min-height:70px;height:auto;transition:all 0.2s ease;overflow:hidden}
.choice-letter{width:48px;height:48px;border-radius:12px;display:inline-flex;align-items:center;justify-content:center;font-weight:900;color:#fff;flex-shrink:0}
.choice-text{flex:1;text-align:left;color:#fff;font-size:clamp(12px,2vw,16px);line-height:1.3;overflow:hidden;text-overflow:ellipsis;word-wrap:break-word}

/* distinct colors (Kahoot-inspired palette) */
.choice-btn.color-0{background:#ff4f9a}
.choice-btn.color-0 .choice-letter{background:rgba(255,255,255,0.14)}
.choice-btn.color-1{background:#ffbf00}
.choice-btn.color-1 .choice-letter{background:rgba(0,0,0,0.12)}
.choice-btn.color-2{background:#00c2ff}
.choice-btn.color-2 .choice-letter{background:rgba(255,255,255,0.12)}
.choice-btn.color-3{background:#a64dff}
.choice-btn.color-3 .choice-letter{background:rgba(255,255,255,0.12)}

.choice-btn.correct{outline:6px solid rgba(255,255,255,0.16);filter:brightness(1.02)}
.choice-btn.wrong{opacity:0.6;transform:scale(0.995)}

/* Nav buttons outside card */
.nav-controls{display:flex;justify-content:center;gap:18px;margin:12px auto 16px;max-width:1100px;width:92%}
#quiz-screen.hidden ~ .nav-controls{display:none}
#quiz-screen.hidden ~ .correct-answer-display{display:none}
.round-btn{background:rgba(255,255,255,0.1);border-radius:999px;border:2px solid rgba(255,255,255,0.2);padding:14px 24px;color:#fff;font-size:16px;font-weight:700;cursor:pointer;transition:all 0.2s ease}
.round-btn:hover{background:rgba(255,255,255,0.18);transform:scale(1.02)}
.round-btn:disabled{opacity:0.4;cursor:not-allowed;transform:scale(1)}

/* when unanswered: all tiles full color; after answer: non-selected become dimmed */
.choice-btn.dimmed{opacity:0.32;filter:grayscale(60%)}
.choice-btn.selected{outline:4px solid rgba(255,255,255,0.5);transform:scale(1.02)}

/* strong green/red feedback for selected choice */
.choice-btn.correct{background:linear-gradient(90deg,#10b981,#34d399) !important;color:#fff;outline:6px solid rgba(16,185,129,0.4) !important}
.choice-btn.wrong{background:linear-gradient(90deg,#f97316,#ef4444) !important;color:#fff;outline:6px solid rgba(239,68,68,0.4) !important}

/* MASSIVE popup feedback modal */
.feedback-modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:9999;backdrop-filter:blur(4px)}
.feedback-modal.hidden{display:none}
.feedback-content{animation:popupBounce 0.4s cubic-bezier(0.34,1.56,0.64,1)}
.feedback-text{font-size:clamp(36px,7vw,64px);font-weight:800;text-align:center;padding:32px;text-shadow:0 8px 24px rgba(0,0,0,0.5)}
.feedback-text.correct{color:#10b981;animation:correctShake 0.4s ease-in-out}
.feedback-text.wrong{color:#ef4444;animation:wrongShake 0.4s ease-in-out}

@keyframes popupBounce{0%{transform:scale(0.5);opacity:0}70%{transform:scale(1.05)}100%{transform:scale(1);opacity:1}}
@keyframes correctShake{0%,100%{transform:translateX(0) rotate(0)}25%{transform:translateX(-4px) rotate(-2deg)}75%{transform:translateX(4px) rotate(2deg)}}
@keyframes wrongShake{0%,100%{transform:translateX(0) rotate(0)}20%{transform:translateX(-6px) rotate(-3deg)}40%{transform:translateX(6px) rotate(3deg)}60%{transform:translateX(-6px) rotate(-3deg)}80%{transform:translateX(6px) rotate(3deg)}}

/* Correct answer display outside quiz box */
.correct-answer-display{max-width:1100px;width:92%;margin:12px auto 8px;padding:14px 20px;background:rgba(16,185,129,0.15);border:2px solid rgba(16,185,129,0.4);border-radius:12px;text-align:center;backdrop-filter:blur(4px)}
.correct-answer-display.hidden{display:none !important}
.correct-label{font-size:14px;font-weight:700;color:rgba(255,255,255,0.8);margin-right:8px}
.correct-answer-text{font-size:16px;font-weight:800;color:#10b981}

.feedback{margin-top:12px;color:rgba(255,255,255,0.95);font-weight:700;text-align:center}

/* Party popper pieces (position relative to q-card) */
#confetti-container{position:relative;overflow:visible;height:0;pointer-events:none}
.confetti-piece{position:absolute;width:12px;height:14px;border-radius:2px;opacity:0.98;transform-origin:center;animation:pop-burst var(--dur,900ms) cubic-bezier(.12,.7,.3,1) forwards}
@keyframes pop-burst{0%{transform:translate(0,0) scale(1) rotate(0);opacity:1}100%{transform:translate(var(--dx,0px),var(--dy,120px)) scale(0.8) rotate(var(--rot,360deg));opacity:0}}
.popper-head{position:absolute;left:50%;top:0;transform:translateX(-50%);width:14px;height:22px;border-radius:6px;background:linear-gradient(180deg,#fff,#ffd9ee);box-shadow:0 6px 18px rgba(0,0,0,0.18);opacity:0.95}

/* Attempts list */
.attempts{padding:10px}
.attempt-item{padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);margin-bottom:8px;background:rgba(255,255,255,0.02);color:#fff}

/* small footer */
.foot.small{text-align:center;padding:12px;color:rgba(255,255,255,0.7)}

/* Mobile: Switch to stacked full-width layout */
@media(max-width:720px){
	.question-text{font-size:clamp(16px,6vw,22px)}
	.kahoot-choices{display:flex;flex-direction:column;gap:10px;grid-template-columns:unset;grid-auto-rows:unset}
	.choice-btn{padding:14px 16px;font-size:16px;height:auto;min-height:60px}
	.choice-letter{width:40px;height:40px}
	.choice-text{font-size:clamp(13px,3.5vw,15px)}
}

/* Short viewport height adjustments */
@media(max-height:930px){
	.kahoot-stage{height:auto;min-height:100vh}
	body{overflow:auto}
	.q-card{margin:15px auto;padding:20px;min-height:auto}
	.kahoot-choices{gap:12px;grid-auto-rows:minmax(65px,auto)}
	.choice-btn{padding:14px;min-height:65px}
}

@media(max-height:700px){
	.q-card{margin:10px auto;padding:16px}
	.question-text{font-size:clamp(16px,4vw,24px);margin-bottom:8px}
	.kahoot-choices{gap:10px;grid-auto-rows:minmax(60px,auto)}
	.choice-btn{padding:12px;min-height:60px;font-size:16px}
	.choice-letter{width:42px;height:42px}
	.nav-controls{margin:10px auto 12px}
}

@media(max-height:550px){
	.topbar{padding:8px 16px}
	.q-card{margin:8px auto;padding:14px}
	.question-text{font-size:clamp(15px,4vw,20px);margin-bottom:6px}
	.question-area{padding:6px 4px 10px}
	.kahoot-choices{gap:8px;grid-auto-rows:minmax(55px,auto)}
	.choice-btn{padding:10px 12px;min-height:55px;font-size:15px;gap:10px}
	.choice-letter{width:38px;height:38px;font-size:16px}
	.choice-text{font-size:clamp(12px,2.5vw,14px);line-height:1.2}
	.nav-controls{margin:8px auto 10px}
	.round-btn{padding:10px 18px;font-size:14px}
}

/* Top result badge */
.top-right{display:flex;align-items:center;gap:12px;position:relative;z-index:100}
.btn{padding:10px 16px;border-radius:999px;border:2px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.1);cursor:pointer;color:#fff;font-weight:700;transition:all 0.2s ease}
.btn:hover{background:rgba(255,255,255,0.18);transform:scale(1.05)}
.btn.small{padding:10px 16px;font-size:14px}
.btn.primary{background:linear-gradient(90deg,#a855f7,#ec4899);border-color:rgba(255,255,255,0.3)}
.top-result{background:rgba(255,255,255,0.06);padding:8px 12px;border-radius:999px;font-weight:800}

/* Result screen controls */
.controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:16px;justify-content:center}

/* MASSIVE celebratory result screen */
.result-big{min-height:520px;max-height:none;height:auto;padding:48px 24px;justify-content:center;align-items:center;overflow:visible}
.result-main{width:100%}
.result-celebration{text-align:center;margin-bottom:32px}
.result-title{font-size:clamp(32px,6vw,64px);font-weight:900;margin:0 0 24px;color:#fff;text-shadow:0 8px 32px rgba(0,0,0,0.3);animation:celebratePulse 2s ease-in-out infinite}
.result-score-big{font-size:clamp(80px,15vw,180px);font-weight:900;color:#10b981;text-shadow:0 12px 48px rgba(16,185,129,0.6);margin:24px 0;line-height:1;animation:scoreGlow 3s ease-in-out infinite;overflow:visible}
.result-subtitle{font-size:clamp(20px,3vw,32px);color:rgba(255,255,255,0.9);font-weight:700;margin:16px 0 0}

/* Attempts full view */
.attempts-view{width:100%;padding:20px 0}
.attempts-view.hidden{display:none}
.attempts-title{font-size:clamp(28px,5vw,48px);font-weight:800;color:#fff;text-align:center;margin:0 0 24px;text-shadow:0 4px 16px rgba(0,0,0,0.3)}
.back-btn{margin-bottom:20px;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.15);color:#fff;padding:12px 24px;border-radius:12px;font-size:16px;font-weight:700;cursor:pointer;transition:all 0.2s ease}
.back-btn:hover{background:rgba(255,255,255,0.15);border-color:rgba(255,255,255,0.3);transform:translateX(-4px)}

/* Attempts list - keep inside card and scrollable */
.attempts{padding:16px;max-height:400px;overflow-y:auto;background:linear-gradient(135deg,rgba(0,0,0,0.3),rgba(0,0,0,0.2));border-radius:16px;border:1px solid rgba(255,255,255,0.1);scrollbar-width:thin;scrollbar-color:rgba(139,92,246,0.6) rgba(0,0,0,0.2)}
.attempts::-webkit-scrollbar{width:10px}
.attempts::-webkit-scrollbar-track{background:rgba(0,0,0,0.2);border-radius:10px;margin:8px 0}
.attempts::-webkit-scrollbar-thumb{background:linear-gradient(180deg,rgba(139,92,246,0.8),rgba(168,85,247,0.6));border-radius:10px;border:2px solid rgba(0,0,0,0.2)}
.attempts::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,rgba(139,92,246,1),rgba(168,85,247,0.9))}
.attempt-item{padding:12px 16px;border-radius:10px;border:1px solid rgba(255,255,255,0.12);margin-bottom:10px;background:linear-gradient(90deg,rgba(139,92,246,0.15),rgba(168,85,247,0.1));color:#fff;font-size:15px;font-weight:600;display:flex;justify-content:space-between;align-items:center;transition:all 0.2s ease}
.attempt-item:hover{background:linear-gradient(90deg,rgba(139,92,246,0.25),rgba(168,85,247,0.2));transform:translateX(4px)}
.attempt-item:last-child{margin-bottom:0}
.attempt-date{font-size:13px;color:rgba(255,255,255,0.7);font-weight:500}
.attempt-score{font-size:16px;color:#10b981;font-weight:800}

@keyframes celebratePulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes scoreGlow{0%,100%{filter:brightness(1)}50%{filter:brightness(1.3)}}

/* Comprehensive mobile optimizations */
@media(max-width:768px){
	/* Allow scrolling on mobile if needed */
	body{overflow:auto}
	.kahoot-stage{min-height:100vh;height:auto}
	
	/* Topbar adjustments */
	.topbar{padding:10px 16px;flex-wrap:wrap;gap:8px}
	.logo{font-size:18px}
	.progress, .top-result{font-size:13px;padding:6px 10px}
	.btn.small{padding:8px 12px;font-size:13px}
	
	/* Card adjustments */
	.q-card{width:95%;padding:18px 14px;min-height:auto;max-height:none;margin:10px auto}
	.question-area{padding:6px 4px 12px}
	
	/* Navigation buttons */
	.nav-controls{gap:12px;margin:16px auto 12px;width:95%}
	.round-btn{padding:12px 18px;font-size:15px;min-width:85px;-webkit-tap-highlight-color:transparent}
	
	/* Correct answer display */
	.correct-answer-display{width:95%;padding:12px 14px;margin:10px auto 8px;font-size:14px}
	.correct-label{font-size:12px}
	.correct-answer-text{font-size:14px}
	
	/* Popup feedback */
	.feedback-text{font-size:clamp(32px,10vw,56px);padding:24px 16px}
	
	/* Result screen */
	.result-big{min-height:auto;padding:32px 16px}
	.result-title{margin-bottom:16px}
	.result-score-big{margin:16px 0}
	.controls{gap:10px;margin-top:20px}
	.btn{padding:11px 16px;font-size:14px;-webkit-tap-highlight-color:transparent}
	
	/* Attempts view */
	.attempts-view{padding:16px 0}
	.attempts-title{margin-bottom:16px}
	.back-btn{padding:10px 18px;font-size:15px;-webkit-tap-highlight-color:transparent}
	.attempts{max-height:350px;padding:12px}
	.attempts::-webkit-scrollbar{width:6px}
	.attempt-item{padding:10px 12px;font-size:14px;flex-direction:column;align-items:flex-start;gap:6px}
	.attempt-score{font-size:14px}
	.attempt-date{font-size:12px}
}

/* Extra small phones */
@media(max-width:480px){
	.topbar{padding:8px 12px}
	.logo{font-size:16px}
	.progress, .top-result{font-size:12px;padding:5px 8px}
	
	.q-card{width:96%;padding:16px 12px}
	.question-text{font-size:clamp(15px,5.5vw,20px)}
	
	.choice-btn{padding:12px 14px;gap:10px;font-size:15px;min-height:58px}
	.choice-letter{width:36px;height:36px;font-size:16px}
	.choice-text{font-size:clamp(12px,4vw,14px);line-height:1.35}
	
	.nav-controls{gap:10px;width:96%}
	.round-btn{padding:11px 16px;font-size:14px;min-width:75px}
	
	.correct-answer-display{width:96%;padding:10px 12px;font-size:13px}
	.correct-answer-text{font-size:13px}
	
	.feedback-text{font-size:clamp(28px,11vw,48px);padding:20px 12px}
	
	.result-score-big{font-size:clamp(56px,20vw,100px)}
	.btn{padding:10px 14px;font-size:13px}
	
	.attempts{max-height:300px;padding:10px}
}

/* Landscape mode on mobile */
@media(max-width:900px) and (max-height:500px) and (orientation:landscape){
	.kahoot-stage{height:auto;min-height:100vh}
	body{overflow:auto}
	.q-card{max-height:none;min-height:auto;margin:15px auto}
	.question-text{font-size:16px;margin-bottom:8px}
	.kahoot-choices{gap:8px}
	.choice-btn{padding:10px 12px;min-height:55px}
	.nav-controls{margin:12px auto}
	.result-big{padding:20px 16px}
}

/* Touch device optimizations */
@media(hover: none) and (pointer: coarse){
	.choice-btn, .round-btn, .btn, .back-btn{-webkit-tap-highlight-color:transparent;touch-action:manipulation}
	.choice-btn:active{transform:scale(0.97);transition:transform 0.1s}
	.round-btn:active:not(:disabled){transform:scale(0.95);transition:transform 0.1s}
	.btn:active{transform:scale(0.95);transition:transform 0.1s}
}
